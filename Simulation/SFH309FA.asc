Version 4
SHEET 1 1664 680
WIRE 864 -384 864 -400
WIRE -160 -336 -192 -336
WIRE 224 -336 224 -400
WIRE 224 -336 32 -336
WIRE 32 -304 32 -336
WIRE -160 -288 -160 -336
WIRE 224 -256 224 -336
WIRE 864 -240 864 -304
WIRE 32 -208 32 -224
WIRE 160 -208 32 -208
WIRE 864 -208 864 -240
WIRE 800 -160 624 -160
WIRE 224 -128 224 -160
WIRE 864 -80 864 -112
FLAG -160 -208 0
FLAG -192 -336 Ee
IOPIN -192 -336 In
FLAG 224 -400 C
IOPIN 224 -400 BiDir
FLAG 224 -128 E
IOPIN 224 -128 BiDir
FLAG 864 -400 0
FLAG 864 -80 0
FLAG 624 -80 0
FLAG 864 -240 X
SYMBOL npn 160 -256 R0
SYMATTR InstName Q1
SYMATTR Value SFH309
SYMBOL bi 32 -304 R0
WINDOW 3 -49 -134 VRight 2
SYMATTR Value I=-i(b2)*Srel(Lambda(time))*v(Ee)/500
SYMATTR InstName B1
SYMBOL res -176 -304 R0
SYMATTR InstName R1
SYMATTR Value 1Meg
SYMBOL npn 800 -208 R0
SYMATTR InstName Q2
SYMATTR Value SFH309
SYMBOL current 864 -384 R0
SYMATTR InstName I1
SYMATTR Value {ipce/Srel(950)*100}
SYMBOL bv 624 -176 R0
SYMATTR InstName B2
SYMATTR Value V=10k*(5-V(X))+0.5
TEXT -240 64 Left 2 !.MODEL SFH309 NPN (IS=22.500E-15 BF=714.44 NF=1.0100 VAF=93.200\n+ IKF=10.010E-3 ISE=22.500E-15 NE=1.7206 VAR=300 NK=.2987 RE=59.2\n+ CJE=9.212E-12 MJE=0.286 VJE=0.627 FC=0.5 CJC=8.735E-12\n+ MJC=0.275 VJC=0.467 TF=0.1E-9)
TEXT -240 -528 Left 2 !.func Srel(Lam) {tbl(Lam,675,0, 700,2, 750,30, 800,80, 850,95, 900,100, 950,95, 1000,80, 1100,13, 1130,6)}
TEXT 320 -280 Left 2 !.param  Ipce=2000u
TEXT -240 -488 Left 2 ;.func Lambda(t) {tbl(t, 0,700, 3.5,700, 3.6,1000, 4,1000, 4.1,700, 6,700)}
